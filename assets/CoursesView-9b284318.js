import{C as T}from"./CoursesCard-dcc04854.js";import{t as V}from"./index-45c61470.js";import{m as v,b as M,f as S,u as H}from"./vueLoadingStore-67bf58d2.js";import{l as L,n as Y,v as B}from"./runtime-dom.esm-bundler-21d14b8b.js";import{b6 as N,av as D,aj as a,l,j as b,s as u,T as F,m as t,b3 as C,F as d,at as m,aJ as n,b1 as h,a3 as j,k as g,t as U}from"./_plugin-vue_export-helper-01f09012.js";const O={data(){return{search:{weeks:[],input:""},isUserSearch:!1,finalSearch:[]}},computed:{...v(S,["courses"]),...v(H,["isLogin"]),hasCanOrder(){let s=!1;return this.courses.forEach(c=>{c.courseDates.forEach(_=>{_.end>new Date&&(s=!0)})}),s}},methods:{...M(S,["getCoursesData","patchSaved"]),toThousand:V,weekText(s){return["日","一","二","三","四","五","六"][this.$date(s).day()]},conversionScore(s){return s?`${(Math.round(s*10)/10).toFixed(1)} / 5.0`:"尚未評分"},clearSearch(){this.search=this.$options.data().search,this.isUserSearch=!1},isUserSaved(s){return s.savedUsersId.includes(+sessionStorage.getItem("userId"))},userSearch(){const{weeks:s,input:c}=this.search;if(!c&&!s.length){this.$swal.fire({icon:"warning",title:"請輸入搜尋訊息",showConfirmButton:!1,timer:1500});return}this.finalSearch=[],this.isUserSearch=!0;const x=JSON.parse(JSON.stringify(this.courses)).filter(i=>i.title.match(this.search.input));if(this.finalSearch=x.filter(i=>i.length!==0),this.search.weeks.length){const i=x.map(o=>{const k=o.courseDates.filter(f=>f.end>new Date&&this.search.weeks.includes(this.weekText(f.start))?f:"");return o.courseDates=k,o});this.finalSearch=i.filter(o=>o.length!==0)}}},components:{CoursesCard:T}},W={class:"wrap"},$=t("h2",{class:"text-3xl font-black font-self text-brand-02"},"茶藝課堂",-1),z=t("label",{for:"keyWord",class:"mr-3"},"課程關鍵字 /",-1),E=t("p",null,"上課時間 /",-1),I={class:"flex flex-wrap gap-3"},J=["for"],A=["name","id","value"],q={class:"flex justify-end gap-5 md:flex-row flex-col md:mt-0 mt-5"},G=t("button",{type:"submit",class:"btn-outline py-2 px-4 duration-500"}," 搜尋 ",-1),K={class:"flex flex-col gap-5 min-h-[7rem] justify-center"},P={key:0,class:"text-2xl text-gray-01 md:tracking-widest text-center"},Q=["src","alt"],R={class:"text-brand-04 text-base self-center font-sans"},X={class:"text-end text-lg"},Z=["onClick"],ee=t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"},null,-1),te=[ee],se={key:2,class:"text-2xl text-gray-01 md:tracking-widest text-center"},re={key:1,class:"text-3xl text-center"},ae=["src","alt"],oe={class:"text-brand-04 text-base self-center font-sans"},ne={class:"text-end text-lg"},le=["onClick"],ie=t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"},null,-1),ce=[ie];function de(s,c,_,x,i,o){const k=D("router-link"),f=D("CoursesCard");return a(),l("main",W,[(a(),b(F,{to:"title"},[u("茶藝課堂")])),$,t("form",{class:"shadow bg-white bg-opacity-20 border-2 border-brand-01 border-opacity-50 mt-2 mb-6 text-xl p-3 grid gap-3",onSubmit:c[3]||(c[3]=Y(()=>o.userSearch(),["prevent"]))},[t("p",null,[z,C(t("input",{type:"text",name:"keyWord",id:"keyWord",placeholder:"請輸入關鍵字...",class:"border border-brand-01 px-3 py-1 md:w-2/3 w-full","onUpdate:modelValue":c[0]||(c[0]=e=>i.search.input=e)},null,512),[[L,i.search.input,void 0,{trim:!0}]])]),t("div",null,[E,t("div",I,[(a(),l(d,null,m(["一","二","三","四","五","六","日"],(e,r)=>t("label",{for:e,class:"cursor-pointer",key:e+r},[C(t("input",{type:"checkbox",name:e,id:e,class:"scale-125 mr-2",value:e,"onUpdate:modelValue":c[1]||(c[1]=p=>i.search.weeks=p)},null,8,A),[[B,i.search.weeks,void 0,{trim:!0}]]),u("星期"+n(e),1)],8,J)),64))])]),t("div",q,[t("button",{type:"button",class:"text-gray-02 py-2 px-4 hover:text-gray-01 duration-500",onClick:c[2]||(c[2]=()=>o.clearSearch())}," 清空列表 "),G])],32),t("ul",K,[i.isUserSearch?(a(),l(d,{key:0},[i.finalSearch.length?i.finalSearch.filter(e=>e.courseDates.length).length?(a(!0),l(d,{key:1},m(i.finalSearch.filter(e=>e.courseDates.length),e=>(a(),l(d,{key:e.id},[(a(!0),l(d,null,m(e.courseDates,(r,p)=>(a(),l(d,{key:`第${p+1}堂-${r}`},[r.end>new Date?(a(),b(f,{key:0},{image:h(()=>[t("img",{src:e.coverUrl,alt:e.title,class:"h-full w-full object-cover"},null,8,Q)]),"card-header":h(()=>[u(n(e.title)+" ",1),t("span",R,n(s.$date(new Date(r.start).toLocaleDateString()).format("YYYY-MM-DD")),1)]),"card-body":h(()=>[t("p",null,[u(" 時間："),t("span",null,"星期"+n(o.weekText(r.start))+" / "+n(s.$dayjs(new Date(r.start)).format("HH:mm"))+"~"+n(s.$dayjs(new Date(r.end)).format("HH:mm")),1)]),t("h2",null,"講師："+n(e.user.name)+" 講師",1),t("p",null," 評分："+n(o.conversionScore(e.scores.reduce((w,y)=>w+y.score,0)/e.scores.length)),1),t("p",X," $ "+n(o.toThousand(e.price)),1)]),"card-footer":h(()=>[s.isLogin?(a(),l("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-label":"課程收藏",class:j(["w-6 h-6 cursor-pointer stroke-brand-02 hover:fill-brand-02",{"fill-brand-02":o.isUserSaved(r)}]),onClick:()=>s.patchSaved(r)},te,10,Z)):g("",!0),U(k,{to:`/course/${r.id}`,class:"btn-primary py-2 px-4"},{default:h(()=>[u("課程詳情")]),_:2},1032,["to"])]),_:2},1024)):g("",!0)],64))),128))],64))),128)):(a(),l("li",se," 該時段暫無課程 ")):(a(),l("li",P," 查無此課程 "))],64)):o.hasCanOrder?(a(!0),l(d,{key:2},m(s.courses,e=>(a(),l(d,{key:e.id},[(a(!0),l(d,null,m(e.courseDates,(r,p)=>(a(),l(d,{key:`第${p+1}堂-${r}`},[r.end>new Date?(a(),b(f,{key:0},{image:h(()=>[t("img",{src:e.coverUrl,alt:e.title,class:"h-full w-full object-cover"},null,8,ae)]),"card-header":h(()=>[u(n(e.title)+" ",1),t("span",oe,n(s.$date(new Date(r.start).toLocaleDateString()).format("YYYY-MM-DD")),1)]),"card-body":h(()=>[t("p",null,[u(" 時間："),t("span",null,"星期"+n(o.weekText(r.start))+" / "+n(s.$dayjs(new Date(r.start)).format("HH:mm"))+"~"+n(s.$dayjs(new Date(r.end)).format("HH:mm")),1)]),t("h2",null,"講師："+n(e.user.name)+" 講師",1),t("p",null," 評分："+n(o.conversionScore(e.scores.reduce((w,y)=>w+y.score,0)/e.scores.length)),1),t("p",ne,"$ "+n(o.toThousand(e.price)),1)]),"card-footer":h(()=>[s.isLogin?(a(),l("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-label":"課程收藏",class:j(["w-6 h-6 cursor-pointer stroke-brand-02 hover:fill-brand-02",{"fill-brand-02":o.isUserSaved(r)}]),onClick:w=>s.patchSaved(r)},ce,10,le)):g("",!0),U(k,{to:`/course/${r.id}`,class:"btn-primary py-2 px-4"},{default:h(()=>[u("課程詳情")]),_:2},1032,["to"])]),_:2},1024)):g("",!0)],64))),128))],64))),128)):(a(),l("li",re," 當前無可預約課程 "))])])}const ke=N(O,[["render",de]]);export{ke as default};
