import{C as M}from"./CourseList-7cb072e5.js";import{D as Y}from"./DiscountInfo-9d143394.js";import{t as B}from"./index-48e7fe8b.js";import{m as d,b as m,f as D,o as w,u as E}from"./vueLoadingStore-27fc4ac1.js";import{b6 as $,av as h,aj as r,l as o,j as T,s as l,aJ as s,T as x,m as t,t as f,b1 as I,k as S,F as L,at as N}from"./_plugin-vue_export-helper-01f09012.js";const{MODE:U}={VITE_BASEURL:"https://2023-vue3-eastern-tea-aroma.onrender.com",BASE_URL:"/2023-Vue3-Eastern-Tea-Aroma/",MODE:"production",DEV:!1,PROD:!0},A={computed:{...d(D,["currentCourse","courses"]),...d(w,["orders"]),...d(E,["isLogin"]),remainingNumber(){const e=[];this.orders.forEach(a=>{a.cart.forEach(c=>{c.courseDateId&&e.push({courseDateId:c.courseDateId,number:c.number})})});let n=0;return e.forEach(a=>{a.courseDateId===+this.$route.params.id&&(n+=a.number)}),n},isSaved(){return this.currentCourse.savedUsersId&&this.currentCourse.savedUsersId.includes(+sessionStorage.getItem("userId"))},modeUrl(){return U==="production"?"https://panduola666.github.io/2023-Vue3-Eastern-Tea-Aroma/#/course/":"http://127.0.0.1:5173/#/course/"},otherTimer(){const e=[];return this.courses.forEach(n=>{n.courseDates.forEach(a=>{var c;a.end>new Date&&a.id!==+this.$route.params.id&&a.courseId===((c=this.currentCourse.course)==null?void 0:c.id)&&e.push(a)})}),e}},methods:{...m(D,["getCurrent","getCoursesData","patchSaved"]),...m(w,["getOrdersData"]),...m(E,["addToCart"]),toThousand:B},watch:{"$route.params.id"(e){e&&this.getCurrent(e)}},mounted(){const{id:e}=this.$route.params;this.getCurrent(e),this.getOrdersData(),this.getCoursesData()},components:{CourseList:M,DiscountInfo:Y}},O={class:"wrap"},R={class:"flex justify-end mb-2"},F=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),J={class:"text-3xl font-black font-self text-brand-02"},P={class:"grid lg:grid-cols-3 gap-3 mt-5"},q=["src","alt"],z={class:"lg:col-span-2 flex flex-col justify-between gap-3 lg:text-xl"},G={class:"flex justify-between items-center"},K={class:"flex justify-between"},Q={class:"text-gray-02 text-base"},W=["disabled"],X={key:0},Z={key:1},ee={key:2},te={class:"text-brand-05 lg:text-lg font-medium leading-8 tracking-wider mt-10"},se=t("p",{class:"font-self text-2xl font-black"},"課程簡介",-1),re={class:"grid gap-4 my-4"},oe=t("p",{class:"font-self text-gray-01 mt-16"},"其他時段",-1),ae={key:1,class:"list-disc list-inside"},ne={key:2,class:"mt-3 text-gray-02"};function ue(e,n,a,c,ie,i){var g,C,b,y,_,k,v;const p=h("router-link"),V=h("DiscountInfo"),j=h("CourseList");return r(),o("main",O,[(r(),T(x,{to:"title"},[l(s((g=e.currentCourse.course)==null?void 0:g.title),1)])),t("div",R,[f(p,{to:"/courses",class:"flex items-center text-gray-02 hover:text-gray-01"},{default:I(()=>[F,l(" 返回搜尋")]),_:1})]),t("h1",J,s((C=e.currentCourse.course)==null?void 0:C.title),1),t("div",P,[t("img",{src:(b=e.currentCourse.course)==null?void 0:b.coverUrl,alt:(y=e.currentCourse.course)==null?void 0:y.title,class:"w-full h-56 object-cover"},null,8,q),t("section",z,[t("h3",G,[l(" 時間："+s(e.$date(e.currentCourse.start).format("YYYY-MM-DD HH:mm"))+"~"+s(e.$date(e.currentCourse.end).format("HH:mm"))+" ",1),e.isLogin?(r(),o("button",{key:0,type:"button",class:"btn-outline flex-shrink-0 md:text-base py-2 px-2 sm:px-5 text-sm",onClick:n[0]||(n[0]=()=>e.patchSaved(e.currentCourse))},s(i.isSaved?"取消收藏":"收藏課程"),1)):S("",!0)]),t("h2",null,"講師："+s((_=e.currentCourse.user)==null?void 0:_.name)+" 講師",1),t("p",K,[l(" 價格："+s(e.currentCourse.course&&i.toThousand((k=e.currentCourse.course)==null?void 0:k.price))+" 元",1),t("span",Q,"剩餘: "+s(e.currentCourse.total-i.remainingNumber),1)]),t("button",{type:"button",class:"btn-primary",disabled:e.currentCourse.total-i.remainingNumber<=0||e.currentCourse.start<new Date,onClick:n[1]||(n[1]=()=>e.addToCart("courses",e.currentCourse))},[e.currentCourse.start<new Date?(r(),o("span",X,"已結束")):e.currentCourse.total-i.remainingNumber<=0?(r(),o("span",Z,"預約已滿")):(r(),o("span",ee,"加入購物車"))],8,W)])]),e.currentCourse.isDiscount?(r(),T(V,{key:0})):S("",!0),t("article",te,[se,t("ul",re,[(r(!0),o(L,null,N((v=e.currentCourse.course)==null?void 0:v.contents,(u,H)=>(r(),o("li",{key:u+H},s(u),1))),128))])]),oe,i.otherTimer.length?(r(),o("ol",ae,[(r(!0),o(L,null,N(i.otherTimer,u=>(r(),o("li",{key:u.id},[f(p,{to:`/course/${u.id}`,class:"hover:text-gray-01 underline underline-offset-2 hover:bg-brand-03 hover:bg-opacity-20"},{default:I(()=>[t("span",null,s(e.$date(u.start).format("YYYY-MM-DD"))+" /星期"+s(["日","一","二","三","四","五","六"][e.$date(u.start).day()])+" - "+s(e.$date(u.start).format("HH:mm"))+"~"+s(e.$date(u.end).format("HH:mm"))+" ／ 價格: "+s(i.toThousand(e.currentCourse.course.price))+" 元 ",1)]),_:2},1032,["to"])]))),128))])):(r(),o("p",ne,"其他日期暫無開課")),f(j,{class:"border-t-2 border-line mt-10 pt-5"})])}const fe=$(A,[["render",ue]]);export{fe as default};
