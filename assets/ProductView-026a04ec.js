import{D as S}from"./DiscountInfo-9d143394.js";import{m as g,b as f,u as y,p as w,o as P}from"./vueLoadingStore-27fc4ac1.js";import{t as T}from"./index-48e7fe8b.js";import{b6 as j,av as N,aj as n,l as c,j as k,s as h,aJ as l,T as D,m as t,k as b,F as u,at as _,t as v,b1 as I}from"./_plugin-vue_export-helper-01f09012.js";const V={data(){return{shoppingNumber:1,productsIdHistory:[]}},computed:{...g(y,["isLogin"]),...g(w,["allProducts"]),...g(P,["orders"]),currentProduct(){const s=this.allProducts.findIndex(r=>r.id===+this.$route.params.id);return this.allProducts.length&&s===-1&&this.notFound(),this.allProducts[s]}},methods:{soldNumber(s){const r=[];this.orders.forEach(i=>{r.push(i.cart)});let a=0;return r.forEach(i=>{i.forEach(o=>{o.productId&&o.productId===s&&(a+=o.number)})}),a},...f(w,["getAllProducts"]),...f(P,["getOrdersData"]),...f(y,["addToCart"]),notFound(){this.$swal.fire({icon:"warning",title:"查無此產品",showConfirmButton:!1,timer:1500}).then(()=>{this.$router.push("/404")})},toThousand:T,setProductsHistory(s){if(localStorage.getItem("productsHistory")){const r=localStorage.getItem("productsHistory").split(",");if(!r.includes(s))r.unshift(s),r.length>4&&r.pop(),localStorage.setItem("productsHistory",r);else{const a=r.findIndex(i=>i===s);r.splice(a,1),r.unshift(s),localStorage.setItem("productsHistory",r)}}else localStorage.setItem("productsHistory",s);this.productsIdHistory=localStorage.getItem("productsHistory")}},watch:{"$route.params.id"(s){console.log(s),this.allProducts.findIndex(a=>a.id===+s)!==-1&&this.setProductsHistory(s)}},mounted(){this.setProductsHistory(this.$route.params.id)},components:{DiscountInfo:S}},B={key:0,class:"wrap"},E=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),A={class:"text-3xl font-black font-self text-brand-02 mb-5"},L={class:"grid lg:grid-cols-3 lg:grid-rows-1 grid-rows-2 grid-cols-1 gap-y-3 lg:gap-x-3"},F=["src","alt"],M={class:"col-span-2 flex flex-col gap-y-3 justify-between"},O={class:"flex flex-wrap items-center gap-3"},U={class:"text-3xl truncate"},J={class:"text-lg flex overflow-hidden pointer-events-none"},q={class:"bg-brand-02 border-2 border-brand-02 px-2 text-white flex-shrink-0"},z={class:"bg-white border-2 border-brand-02 px-2 truncate"},G={class:"flex flex-wrap gap-2 justify-between text-gray-02 items-center text-lg"},K={class:"text-2xl text-gray-01"},Q={class:"flex gap-3 justify-between lg:items-center lg:flex-row flex-col"},R={class:"flex items-center h-10 lg:h-8"},W=["disabled"],X=t("img",{src:"https://github.com/panduola666/2023-Vue3-Eastern-Tea-Aroma/blob/main/public/icon-.png?raw=true",alt:"收合"},null,-1),Y=[X],Z={class:"flex items-center justify-around p-2 border-y-2 border-brand-01 bg-opacity-40 bg-white min-w-[100px] w-full"},$=["disabled"],tt=t("img",{src:"https://github.com/panduola666/2023-Vue3-Eastern-Tea-Aroma/blob/main/public/icon+.png?raw=true",alt:"展開"},null,-1),et=[tt],rt=["disabled"],st={class:"text-brand-05 text-lg font-medium grid gap-4 mt-10"},ot=t("p",{class:"text-2xl font-black font-self"},"介紹",-1),lt=["innerHTML"],nt=t("p",{class:"text-brand-05 text-xl font-black font-self mt-10"},"同類商品比較",-1),dt={class:"w-full divide-y divide-gray-01 border border-gray-01 table-fixed"},ct=t("thead",null,[t("tr",{class:"bg-brand-01 bg-opacity-50"},[t("th",{class:"py-2"},"名稱"),t("th",null,"系列"),t("th",null,"價格"),t("th",null,"銷量")])],-1),at={class:"bg-white bg-opacity-30 text-center divide-y divide-gray-01"},it={key:0},ut={class:"py-2"},pt=t("p",{class:"text-xl text-gray-02 mt-10"},"瀏覽紀錄",-1),ht={class:"grid md:grid-cols-4 gap-3 mt-3"},bt={key:0,class:"overflow-hidden opacity-80"},mt=["src","alt"],gt={class:"absolute bg-[rgba(0,52,22,.5)] text-white bottom-0 left-0 right-0 p-2 font-self font-semibold text-lg truncate"};function ft(s,r,a,i,o,e){const H=N("DiscountInfo"),x=N("router-link");return e.currentProduct?(n(),c("main",B,[(n(),k(D,{to:"title"},[h(l(e.currentProduct.name),1)])),t("p",{class:"flex items-center justify-end text-gray-02 hover:text-gray-01 cursor-pointer",onClick:r[0]||(r[0]=()=>this.$router.go(-1))},[E,h(" 返回搜尋 ")]),t("h1",A,l(e.currentProduct.name),1),t("div",L,[t("img",{src:e.currentProduct.coverUrl,alt:e.currentProduct.name,class:"object-cover h-[250px] w-full"},null,8,F),t("div",M,[t("section",O,[t("h2",U,l(e.currentProduct.name),1),t("p",J,[t("span",q,l(e.currentProduct.group),1),t("span",z,l(e.currentProduct.type),1)])]),t("p",G,[h(" 剩餘: "+l(e.currentProduct.totalNumber-e.soldNumber(s.$route.params.id))+" ",1),t("span",K,"$ "+l(e.toThousand(e.currentProduct.price)*o.shoppingNumber),1)]),t("div",Q,[t("div",R,[t("button",{type:"button",class:"btn-outline p-2 md:px-4 focus:outline-0 flex-shrink-0 disabled:border-brand-01 disabled:bg-inherit disabled:grayscale",disabled:o.shoppingNumber<=1,onClick:r[1]||(r[1]=()=>o.shoppingNumber>1?o.shoppingNumber--:o.shoppingNumber)},Y,8,W),t("p",Z,l(o.shoppingNumber),1),t("button",{type:"button",class:"btn-outline p-2 md:px-4 focus:outline-0 flex-shrink-0 disabled:border-brand-01 disabled:bg-inherit disabled:grayscale",disabled:o.shoppingNumber===e.currentProduct.totalNumber-e.soldNumber(s.$route.params.id),onClick:r[2]||(r[2]=()=>o.shoppingNumber<e.currentProduct.totalNumber-e.soldNumber(s.$route.params.id)?o.shoppingNumber++:"")},et,8,$)]),t("button",{type:"button",class:"btn-primary py-2 px-4 text-xl",disabled:!(e.currentProduct.totalNumber-e.soldNumber(s.$route.params.id)),onClick:r[3]||(r[3]=()=>s.addToCart("products",e.currentProduct,o.shoppingNumber))},l(e.currentProduct.totalNumber-e.soldNumber(s.$route.params.id)?"加入購物車":"已售完"),9,rt)])])]),e.currentProduct.isDiscount?(n(),k(H,{key:0})):b("",!0),t("article",st,[ot,t("p",{innerHTML:e.currentProduct.content},null,8,lt)]),nt,t("table",dt,[ct,t("tbody",at,[(n(!0),c(u,null,_(s.allProducts,(d,m)=>(n(),c(u,{key:m},[d.group===e.currentProduct.group?(n(),c("tr",it,[t("td",ut,[v(x,{to:`/product/${d.id}`,class:"underline text-brand-02 hover:text-brand-01"},{default:I(()=>[h(l(d.name),1)]),_:2},1032,["to"])]),t("td",null,l(d.type),1),t("td",null,l(d.price),1),t("td",null,l(e.soldNumber(d.id)),1)])):b("",!0)],64))),128))])]),pt,t("ul",ht,[(n(!0),c(u,null,_(o.productsIdHistory,(d,m)=>(n(),c(u,{key:d+m},[(n(!0),c(u,null,_(s.allProducts,(p,C)=>(n(),c(u,{key:C},[p.id===+d?(n(),c("li",bt,[v(x,{to:`/product/${p.id}`,class:"relative group"},{default:I(()=>[t("img",{src:p.coverUrl,alt:p.name,class:"w-full h-36 object-cover group-hover:scale-110 duration-1000"},null,8,mt),t("p",gt,l(p.name),1)]),_:2},1032,["to"])])):b("",!0)],64))),128))],64))),128))])])):b("",!0)}const Pt=j(V,[["render",ft]]);export{Pt as default};
