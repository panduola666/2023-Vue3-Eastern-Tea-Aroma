import{D as H}from"./DiscountInfo-32c3b1ae.js";import{m as h,b as p,u as f,p as _,o as x}from"./vueLoadingStore-98d1fb2a.js";import{t as S}from"./index-07d2539f.js";import{b6 as C,av as y,aj as i,l as a,j as w,s as m,aJ as l,T,m as t,k as b,F as u,at as P,t as j,b1 as D}from"./_plugin-vue_export-helper-01f09012.js";const E={data(){return{shoppingNumber:1}},computed:{...h(f,["isLogin"]),...h(_,["allProducts"]),...h(x,["orders"]),currentProduct(){const s=this.allProducts.findIndex(e=>e.id===+this.$route.params.id);return this.allProducts.length&&s===-1&&this.notFound(),this.allProducts[s]},soldNumber(){const s=[];this.orders.forEach(o=>{s.push(o.cart)});let e=0;return s.forEach(o=>{o.forEach(c=>{c.productId&&c.productId===+this.$route.params.id&&(e+=c.number)})}),e},productsIdHistory(){if(localStorage.getItem("productsHistory"))return localStorage.getItem("productsHistory").split(",")}},methods:{...p(_,["getAllProducts"]),...p(x,["getOrdersData"]),...p(f,["addToCart"]),notFound(){this.$swal.fire({icon:"warning",title:"查無此產品",showConfirmButton:!1,timer:1500}).then(()=>{this.$router.push("/404")})},toThousand:S,setProductsHistory(s){if(localStorage.getItem("productsHistory")){const e=localStorage.getItem("productsHistory").split(",");if(!e.includes(s))e.unshift(s),e.length>4&&e.pop(),localStorage.setItem("productsHistory",e);else{const o=e.findIndex(c=>c===s);e.splice(o,1),e.unshift(s),localStorage.setItem("productsHistory",e)}}else localStorage.setItem("productsHistory",s)},historyData(){const s=localStorage.getItem("productsHistory").split(","),e=[];this.allProducts.forEach(o=>{s.forEach(c=>{o.id===+c&&e.push(o)})}),this.history=e}},watch:{"$route.params.id"(s){this.allProducts.findIndex(o=>o.id===+s)!==-1&&this.setProductsHistory(s)}},components:{DiscountInfo:H}},V={key:0,class:"wrap"},B=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})],-1),A={class:"text-3xl font-black font-self text-brand-02 mb-5"},L={class:"grid lg:grid-cols-3 lg:grid-rows-1 grid-rows-2 grid-cols-1 gap-y-3 lg:gap-x-3"},F=["src","alt"],M={class:"col-span-2 flex flex-col gap-y-3 justify-between"},O={class:"flex flex-wrap items-center gap-3"},U={class:"text-3xl truncate"},J={class:"text-lg flex overflow-hidden pointer-events-none"},q={class:"bg-brand-02 border-2 border-brand-02 px-2 text-white flex-shrink-0"},z={class:"bg-white border-2 border-brand-02 px-2 truncate"},G={class:"flex flex-wrap gap-2 justify-between text-gray-02 items-center text-lg"},K={class:"text-2xl text-gray-01"},Q={class:"flex gap-3 justify-between lg:items-center lg:flex-row flex-col"},R={class:"flex items-center h-10 lg:h-8"},W=["disabled"],X=t("img",{src:"https://github.com/panduola666/2023-Vue3-Eastern-Tea-Aroma/blob/main/public/icon-.png?raw=true",alt:"收合"},null,-1),Y=[X],Z={class:"flex items-center justify-around p-2 border-y-2 border-brand-01 bg-opacity-40 bg-white min-w-[100px] w-full"},$=["disabled"],tt=t("img",{src:"https://github.com/panduola666/2023-Vue3-Eastern-Tea-Aroma/blob/main/public/icon+.png?raw=true",alt:"展開"},null,-1),et=[tt],rt=["disabled"],st={class:"text-brand-05 text-lg font-medium grid gap-4 mt-10"},ot=t("p",{class:"text-2xl font-black font-self"},"介紹",-1),nt=["innerHTML"],lt=t("p",{class:"text-xl text-gray-02 mt-10"},"瀏覽紀錄",-1),ct={class:"grid md:grid-cols-4 gap-3 mt-3"},it={key:0,class:"overflow-hidden opacity-80"},at=["src","alt"],dt={class:"absolute bg-[rgba(0,52,22,.5)] text-white bottom-0 left-0 right-0 p-2 font-self font-semibold text-lg truncate"};function ut(s,e,o,c,n,r){const N=y("DiscountInfo"),k=y("router-link");return r.currentProduct?(i(),a("main",V,[(i(),w(T,{to:"title"},[m(l(r.currentProduct.name),1)])),t("p",{class:"flex items-center justify-end text-gray-02 hover:text-gray-01 cursor-pointer",onClick:e[0]||(e[0]=()=>this.$router.go(-1))},[B,m(" 返回搜尋 ")]),t("h1",A,l(r.currentProduct.name),1),t("div",L,[t("img",{src:r.currentProduct.coverUrl,alt:r.currentProduct.name,class:"object-cover h-[250px] w-full"},null,8,F),t("div",M,[t("section",O,[t("h2",U,l(r.currentProduct.name),1),t("p",J,[t("span",q,l(r.currentProduct.group),1),t("span",z,l(r.currentProduct.type),1)])]),t("p",G,[m(" 剩餘: "+l(r.currentProduct.totalNumber-r.soldNumber)+" ",1),t("span",K,"$ "+l(r.toThousand(r.currentProduct.price)*n.shoppingNumber),1)]),t("div",Q,[t("div",R,[t("button",{type:"button",class:"btn-outline p-2 md:px-4 focus:outline-0 flex-shrink-0 disabled:border-brand-01 disabled:bg-inherit disabled:grayscale",disabled:n.shoppingNumber<=1,onClick:e[1]||(e[1]=()=>n.shoppingNumber>1?n.shoppingNumber--:n.shoppingNumber)},Y,8,W),t("p",Z,l(n.shoppingNumber),1),t("button",{type:"button",class:"btn-outline p-2 md:px-4 focus:outline-0 flex-shrink-0 disabled:border-brand-01 disabled:bg-inherit disabled:grayscale",disabled:n.shoppingNumber===r.currentProduct.totalNumber-r.soldNumber,onClick:e[2]||(e[2]=()=>n.shoppingNumber<r.currentProduct.totalNumber-r.soldNumber?n.shoppingNumber++:"")},et,8,$)]),t("button",{type:"button",class:"btn-primary py-2 px-4 text-xl",disabled:!(r.currentProduct.totalNumber-r.soldNumber),onClick:e[3]||(e[3]=()=>s.addToCart("products",r.currentProduct,n.shoppingNumber))},l(r.currentProduct.totalNumber-r.soldNumber?"加入購物車":"已售完"),9,rt)])])]),r.currentProduct.isDiscount?(i(),w(N,{key:0})):b("",!0),t("article",st,[ot,t("p",{innerHTML:r.currentProduct.content},null,8,nt)]),lt,t("ul",ct,[(i(!0),a(u,null,P(r.productsIdHistory,(g,v)=>(i(),a(u,{key:g+v},[(i(!0),a(u,null,P(s.allProducts,(d,I)=>(i(),a(u,{key:I},[d.id===+g?(i(),a("li",it,[j(k,{to:`/product/${d.id}`,class:"relative group"},{default:D(()=>[t("img",{src:d.coverUrl,alt:d.name,class:"w-full h-36 object-cover group-hover:scale-110 duration-1000"},null,8,at),t("p",dt,l(d.name),1)]),_:2},1032,["to"])])):b("",!0)],64))),128))],64))),128))])])):b("",!0)}const gt=C(E,[["render",ut]]);export{gt as default};
